# RISC-V RV32I Processor

This repository contains the implementation of a **RISC-V RV32I processor**, supporting both **single-cycle** and **pipelined** datapath versions. The design adheres to the RISC-V instruction set architecture (ISA) for 32-bit integer operations (RV32I), commonly referred to as RV32I.

---

## Features

### Single-Cycle Processor
- **Architecture**: Implements the RV32I base integer instruction set.
- **Design**: Follows a single-cycle processor model, meaning all instructions execute in a single clock cycle.
- **Modules**:
  - **Program Counter (PC)**: Holds the address of the current instruction.
  - **Instruction Memory (Imem)**: Fetches instructions for execution.
  - **Register File (Regfile)**: Provides read/write access to 32 general-purpose registers.
  - **Immediate Generator (Immgen)**: Decodes and generates immediate values.
  - **ALU**: Performs arithmetic and logic operations.
  - **Branch Comparator (Brcmp)**: Handles conditional branch instructions.
  - **Load/Store Unit (LSU)**: Manages data memory access for load/store instructions.
- **Control Unit**: Generates control signals for all modules.
- **I/O Interface**: Enables interaction with peripherals such as LEDs, switches, and debugging outputs.

### Pipelined Processor
- **Five-Stage Pipeline**:
  1. **Instruction Fetch (IF)**: Fetches instruction from memory.
  2. **Instruction Decode (ID)**: Decodes instruction and reads registers.
  3. **Execute (EX)**: Performs ALU operations and computes addresses.
  4. **Memory Access (MEM)**: Reads/writes data memory.
  5. **Write-Back (WB)**: Writes results back to the register file.
- **Hazard Handling**:
  - **Hazard Detection Unit**: Detects data hazards and stalls pipeline when necessary.
  - **Forwarding Unit**: Resolves data hazards by forwarding results from later stages.
  - **Branch Prediction**: Implements basic branch prediction to mitigate control hazards.

---

## Supported Instructions

The following instruction types are supported:

1. **R-Type**: Arithmetic and logical operations.
   - `ADD`, `SUB`, `AND`, `OR`, `XOR`, `SLL`, `SRL`, `SRA`, `SLT`, `SLTU`
2. **I-Type**: Immediate arithmetic, load instructions, and some control transfers.
   - `ADDI`, `ANDI`, `ORI`, `XORI`, `SLLI`, `SRLI`, `SRAI`, `SLTI`, `SLTIU`, `LB`, `LH`, `LW`, `LBU`, `LHU`, `JALR`
3. **S-Type**: Store instructions.
   - `SB`, `SH`, `SW`
4. **B-Type**: Conditional branches.
   - `BEQ`, `BNE`, `BLT`, `BGE`, `BLTU`, `BGEU`
5. **J-Type**: Jump instructions.
   - `JAL`
6. **U-Type**: Immediate values for upper bits.
   - `LUI`, `AUIPC`

---

## Block Diagram Description

The processor consists of the following key components:

### Single-Cycle Components
- **Program Counter (PC)**: Holds the address of the current instruction and increments it by 4 for sequential execution.
- **Instruction Memory (Imem)**: Provides the instruction at the address specified by the PC.
- **Register File (Regfile)**: Provides read access to two source registers and write access to the destination register.
- **Immediate Generator (Immgen)**: Extracts and signs-extends immediate values for I-Type, S-Type, B-Type, U-Type and J-Type instructions.
- **ALU**: Performs arithmetic and logical operations on two inputs.
- **Branch Comparator (Brcmp)**: Determines the outcome of conditional branches.
- **Load/Store Unit (LSU)**: Handles data memory access for load and store instructions.
- **Control Unit (Ctrlunit)**: Generates control signals based on the opcode, determining the behavior of the processor.
- **Multiplexers**: Allow dynamic selection of inputs for operands, write-back data, and next PC address.

### Pipelined Components
- **Pipeline Registers**: Store intermediate values between stages.
- **Hazard Detection Unit**: Detects and resolves stalls.
- **Forwarding Unit**: Reduces stalls by forwarding data between pipeline stages.

---

## Control Signals

The processor is controlled by a set of control signals generated by the **Control Unit**:

| Signal   | Description                                      |
|----------|--------------------------------------------------|
| `pcsel`  | Selects the source of the next PC address        |
| `immsel` | Selects the immediate extension mode             |
| `brun`   | Selects signed or unsigned for branch comparison |
| `asel`   | Selects the first ALU operand                    |
| `bsel`   | Selects the second ALU operand                   |
| `op`     | Specifies the ALU operation                      |
| `regwen` | Enables writing to the register file             |
| `wren`   | Enables memory write in the LSU                  |
| `wbsel`  | Selects data for write-back to registers         |

---

## I/O Interface

The processor includes basic input/output capabilities for debugging and testing:

| I/O Signal | Description                      |
|------------|----------------------------------|
| `ledr`     | Output to red LEDs               |
| `ledg`     | Output to green LEDs             |
| `hex0..7`  | Output to 7-segment displays     |
| `sw`       | Input switches                   |
| `btn`      | Input buttons                    |
| `pcdebug`  | Debug output for program counter |

---

## Future Enhancements
- Implement **Branch Prediction**: Implement dynamic prediction techniques.
- Add support for the **RV32M Extension**: Add support for multiplication and division instructions.
- Extend design for **Exception Handling**: Support interrupts and basic exception handling.
- Introduce **Memory Hierarchy**: A cache for improved memory performance.

---

## References

1. [RISC-V Instruction Set Manual](https://riscv.org/technical/specifications/)
2. [RISC-V Assembly Programming](https://riscvasm.github.io/)

---

**Author**: GHP 

---
